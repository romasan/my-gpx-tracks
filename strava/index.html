<script>
console.log('v0.0.4');
const get = (url, token) => fetch(url, {
    method: 'GET',
    headers: new Headers({
        Authorization: 'Bearer ' + token
    })
});

const search = [...(new URL(location.href)).searchParams.entries()].reduce((l, [k, e])=>({...l, [k]: e}), {});

if (search.code) {
    console.log('case 1', search);
} else {
    location.href = 'https://www.strava.com/oauth/authorize?' + [{
        client_id: '29536',
        redirect_uri: location.href.split('?')[0],
        response_type: 'code',
        scope: 'read'
    }]
    .reduce((x,o)=>(Object.entries(o)), 0)
    .map(([k,e])=>k+'='+e)
    .join('&')
}
</script>